<!DOCTYPE html>
<html>
<head>
  <title>Flat Admin V.3 - Free flat-design bootstrap administrator templates</title>
  
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="stylesheet" type="text/css" href="css/vendor.css">
  <link rel="stylesheet" type="text/css" href="css/flat-admin.css">

  <!-- Theme -->
  <link rel="stylesheet" type="text/css" href="css/theme/blue-sky.css">
  <link rel="stylesheet" type="text/css" href="css/theme/blue.css">
  <link rel="stylesheet" type="text/css" href="css/theme/red.css">
  <link rel="stylesheet" type="text/css" href="css/theme/yellow.css">

</head>
<body>
  <div class="app app-default">

<aside class="app-sidebar" id="sidebar">
  <div class="sidebar-header">
    <a class="sidebar-brand" href="#"><img class="img-responsive" src="images/curpha.png"></a>
    <button type="button" class="sidebar-toggle">
      <i class="fa fa-times"></i>
    </button>
  </div>
  <div class="sidebar-menu">
    <ul class="sidebar-nav">
      <li class="active">
        <a href="#">
          <div class="icon">
            <i class="fa fa-dashboard" aria-hidden="true"></i>
          </div>
          <div class="title">Dashboard</div>
        </a>
      </li>

      <li class="dropdown ">
        <a href="{{site.uri.public}}/monitor">
          <div class="icon">
            <i class="fa fa-bar-chart-o" aria-hidden="true"></i>
          </div>
          <div class="title">Monitor</div>
        </a>
      </li>
      
      <li class="dropdown">
        <a href="{{site.uri.public}}/configure">
          <div class="icon">
            <i class="fa fa-wrench" aria-hidden="true"></i>
          </div>
          <div class="title">Configure</div>
        </a>
      </li>
      
      <li class="dropdown">
        <a href="{{site.uri.public}}/help">
          <div class="icon">
            <i class="fa fa-question-circle" aria-hidden="true"></i>
          </div>
          <div class="title">Help</div>
        </a>
      </li>
      
    </ul>
  </div>
  <div class="sidebar-footer">
    <ul class="menu">
      <li>
        <a href="/" class="dropdown-toggle" data-toggle="dropdown">
          <i class="fa fa-cogs" aria-hidden="true"></i>
        </a>
      </li>
      <li><a href="#"><span class="flag-icon flag-icon-th flag-icon-squared"></span></a></li>
    </ul>
  </div>
</aside>

<script type="text/ng-template" id="sidebar-dropdown.tpl.html">
  <div class="dropdown-background">
    <div class="bg"></div>
  </div>
  <div class="dropdown-container">
    {{list}}
  </div>
</script>
<div class="app-container">

  <nav class="navbar navbar-default" id="navbar">
  <div class="container-fluid">
    <div class="navbar-collapse collapse in">
      <ul class="nav navbar-nav navbar-mobile">
        <li>
          <button type="button" class="sidebar-toggle">
            <i class="fa fa-bars"></i>
          </button>
        </li>
        <li class="logo">
          <a class="navbar-brand" href="#"><span class="highlight">Flat v3</span> Admin</a>
        </li>
        <li>
          <button type="button" class="navbar-toggle">
            <img class="profile-img" src="images/profile.png">
          </button>
        </li>
      </ul>
      <ul class="nav navbar-nav navbar-left">
        <li class="navbar-title">Dashboard for {{userName}}</li>
        <li class="navbar-search hidden-sm">
          <input id="search" type="text" placeholder="Search..">
          <button class="btn-search"><i class="fa fa-search"></i></button>
        </li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown notification">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">
            <div class="icon"><i class="fa fa-shopping-basket" aria-hidden="true"></i></div>
            <div class="title">New Orders</div>
            <div class="count">0</div>
          </a>
          <div class="dropdown-menu">
            <ul>
              <li class="dropdown-header">Ordering</li>
              <li class="dropdown-empty">No New Ordered</li>
              <li class="dropdown-footer">
                <a href="#">View All <i class="fa fa-angle-right" aria-hidden="true"></i></a>
              </li>
            </ul>
          </div>
        </li>
        <li class="dropdown notification warning">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">
            <div class="icon"><i class="fa fa-comments" aria-hidden="true"></i></div>
            <div class="title">Unread Messages</div>
            <div class="count">99</div>
          </a>
          <div class="dropdown-menu">
            <ul>
              <li class="dropdown-header">Message</li>
              <li>
                <a href="#">
                  <span class="badge badge-warning pull-right">10</span>
                  <div class="message">
                    <img class="profile" src="https://placehold.it/100x100">
                    <div class="content">
                      <div class="title">"Payment Confirmation.."</div>
                      <div class="description">Alan Anderson</div>
                    </div>
                  </div>
                </a>
              </li>
              <li>
                <a href="#">
                  <span class="badge badge-warning pull-right">5</span>
                  <div class="message">
                    <img class="profile" src="https://placehold.it/100x100">
                    <div class="content">
                      <div class="title">"Hello World"</div>
                      <div class="description">Marco  Harmon</div>
                    </div>
                  </div>
                </a>
              </li>
              <li>
                <a href="#">
                  <span class="badge badge-warning pull-right">2</span>
                  <div class="message">
                    <img class="profile" src="https://placehold.it/100x100">
                    <div class="content">
                      <div class="title">"Order Confirmation.."</div>
                      <div class="description">Brenda Lawson</div>
                    </div>
                  </div>
                </a>
              </li>
              <li class="dropdown-footer">
                <a href="#">View All <i class="fa fa-angle-right" aria-hidden="true"></i></a>
              </li>
            </ul>
          </div>
        </li>
        <li class="dropdown notification danger">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">
            <div class="icon"><i class="fa fa-bell" aria-hidden="true"></i></div>
            <div class="title">System Notifications</div>
            <div class="count">10</div>
          </a>
          <div class="dropdown-menu">
            <ul>
              <li class="dropdown-header">Notification</li>
              <li>
                <a href="#">
                  <span class="badge badge-danger pull-right">8</span>
                  <div class="message">
                    <div class="content">
                      <div class="title">New Order</div>
                      <div class="description">$400 total</div>
                    </div>
                  </div>
                </a>
              </li>
              <li>
                <a href="#">
                  <span class="badge badge-danger pull-right">14</span>
                  Inbox
                </a>
              </li>
              <li>
                <a href="#">
                  <span class="badge badge-danger pull-right">5</span>
                  Issues Report
                </a>
              </li>
              <li class="dropdown-footer">
                <a href="#">View All <i class="fa fa-angle-right" aria-hidden="true"></i></a>
              </li>
            </ul>
          </div>
        </li>
        <li class="dropdown profile">
          <a href="#" class="dropdown-toggle"  data-toggle="dropdown">
            <img class="profile-img" src="images/profile.png">
            <div class="title">Profile</div>
          </a>
          <div class="dropdown-menu">
            <div class="profile-info">
              <h4 class="username">Scott White</h4>
            </div>
            <ul class="action">
              <li>
                <a href="#">
                  Profile
                </a>
              </li>
              <li>
                <a href="#">
                  <span class="badge badge-danger pull-right">5</span>
                  My Inbox
                </a>
              </li>
              <li>
                <a href="#">
                  Setting
                </a>
              </li>
              <li>
                <a href="{{site.uri.public}}/account/logout">
                  Logout
                </a>
              </li>
            </ul>
          </div>
        </li>
      </ul>
    </div>
  </div>
</nav>

  <div class="btn-floating" id="help-actions">
  <div class="btn-bg"></div>
  <button type="button" class="btn btn-default btn-toggle" data-toggle="toggle" data-target="#help-actions">
    <i class="icon fa fa-plus"></i>
    <span class="help-text">Shortcut</span>
  </button>
  <div class="toggle-content">
    <ul class="actions">
      <li><a data-toggle="modal" data-target="#addAccessPoint" href="#">Access Point</a></li>
      <li><a data-toggle="modal" data-target="#addCamera" href="#">Camera</a></li>
      <li><a data-toggle="modal" data-target="#addOther" href="#">Other</a></li>
    </ul>
  </div>
</div>
  


    <div class="modal fade" id="addAccessPoint" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title">Add New Access Point</h4>
          </div>
          <div class="modal-body">
          <div class="" role="" id="alertAddDevice"></div>
            <p>Please enter the serial number you will find at the back of the device and click "Add"</p>
            <input class="form-control" placeholder="Serial Number" id="deviceSerialNumber">
                <div class="" id="progressDiv">
                        <div id="progressBar" class="progress-bar progress-bar-success  progress-bar-striped active" role="progressbar" aria-valuenow="80" aria-valuemin="0" aria-valuemax="100" style=""></div>
                </div>
            <img class="img-responsive" src="images/serialNumber.PNG">
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-sm btn-default" data-dismiss="modal">Cancel</button>
            <button class="btn btn-success" id="addDeviceButton">Add</button>
          </div>
        </div>
      </div>
    </div>
    
        <div class="modal fade" id="addCamera" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title">Add New Camera</h4>
          </div>
          <div class="modal-body">
            <p>Coming Soon .... !!</p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-sm btn-default" data-dismiss="modal">Cancel</button>
            <button class="btn btn-success">Add</button>
          </div>
        </div>
      </div>
    </div>
    
        <div class="modal fade" id="addOther" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title">Add New Device</h4>
          </div>
          <div class="modal-body">
            <p>Coming Soon .... !!</p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-sm btn-default" data-dismiss="modal">Cancel</button>
            <button class="btn btn-success">Add</button>
          </div>
        </div>
      </div>
    </div>


<div class="row">
  <div class="col-xs-12">
    <div class="card card-banner card-chart card-green no-br">
      <div class="card-header">
        <div class="card-title">
          <div class="title">Top Sale Today</div>
        </div>
        <ul class="card-action">
          <li>
            <a href="#">
              <i class="fa fa-refresh"></i>
            </a>
          </li>
        </ul>
      </div>
      <div class="card-body">
        <div class="ct-chart-sale"></div>
      </div>
    </div>
  </div>
</div>
<div class="row">
  <div class="col-lg-4 col-md-6 col-sm-6 col-xs-12">
      <a class="card card-banner card-green-light">
  <div class="card-body">
    <i class="icon fa fa-shopping-basket fa-4x"></i>
    <div class="content">
      <div class="title">Sale Today</div>
      <div class="value"><span class="sign">$</span>420</div>
    </div>
  </div>
</a>

  </div>
  <div class="col-lg-4 col-md-6 col-sm-6 col-xs-12">
      <a class="card card-banner card-blue-light">
  <div class="card-body">
    <i class="icon fa fa-thumbs-o-up fa-4x"></i>
    <div class="content">
      <div class="title">Page Likes</div>
      <div class="value"><span class="sign"></span>2453</div>
    </div>
  </div>
</a>

  </div>
  <div class="col-lg-4 col-md-6 col-sm-6 col-xs-12">
      <a class="card card-banner card-yellow-light">
  <div class="card-body">
    <i class="icon fa fa-user-plus fa-4x"></i>
    <div class="content">
      <div class="title">New Registration</div>
      <div class="value"><span class="sign"></span>50</div>
    </div>
  </div>
</a>

  </div>
</div>

<div class="row">
  <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
    <div class="card card-mini">
      <div class="card-header">
        <div class="card-title">Your Devices</div>
        <ul class="card-action">
          <li>
            <a href="{{site.uri.public}}/dashboard">
              <i class="fa fa-refresh"></i>
            </a>
          </li>
        </ul>
      </div>
      <div class="table-responsive">
  <table class="table card-table">
    <thead>
      <tr>
        <th>Device name</th>
        <th>Serial Number</th>
        <th>Status</th>
        <th>Configure</th>
      </tr>
    </thead>
    <tbody>
      <p id="endPointCounter" endPointCount = "{{endPointsData|length}}"></p>
      {% for endPoint in endPointsData %}
      <tr>
        <td>EndPoint {{ loop.index }}</td>
        <td>{{ endPoint.endpointSerialNumber}}</td>
        <td><span class="badge badge-success badge-icon"><i class="fa fa-check" aria-hidden="true"></i><span>Connected</span></span></td>
        <td><button type="button" class="btn btn-success btn-toggle btn-xs" data-toggle="modal" data-target="#changeSSID{{ loop.index }}">Test</button></td>
      </tr>
          <div class="modal fade" id="changeSSID{{ loop.index }}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title">Change SSID</h4>
          </div>
          <div class="modal-body">
            <p>Please enter the new SSID and then click "Change"</p>
            <input class="form-control" placeholder="Enter Command" id="command{{ loop.index }}">
            <div class="" role="" id="alertUser{{ loop.index }}"></div>
            <div id="loadingIcon{{ loop.index }}"></div>
          <div class="modal-footer">
            <button type="button" class="btn btn-sm btn-default" data-dismiss="modal">Cancel</button>
            <button type="button" class="btn btn-primary" id="executeButton{{ loop.index }}" endPointKeyHash="{{ endPoint.endpointKey}}">Change</button>
          </div>
        </div>
      </div>
    </div>
      {% endfor %}
    </tbody>
  </table>
</div>
    </div>
  </div>

  <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
    <div class="card card-tab card-mini">
      <div class="card-header">
        <ul class="nav nav-tabs tab-stats">
          <li role="tab1" class="active">
            <a href="#tab1" aria-controls="tab1" role="tab" data-toggle="tab">Browsers</a>
          </li>
          <li role="tab2">
            <a href="#tab2" aria-controls="tab2" role="tab" data-toggle="tab">OS</a>
          </li>
          <li role="tab2">
            <a href="#tab3" aria-controls="tab3" role="tab" data-toggle="tab">More</a>
          </li>
        </ul>
      </div>
      <div class="card-body tab-content">
        <div role="tabpanel" class="tab-pane active" id="tab1">
          <div class="row">
            <div class="col-sm-8">
              <div class="chart ct-chart-browser ct-perfect-fourth"></div>
            </div>
            <div class="col-sm-4">
              <ul class="chart-label">
                <li class="ct-label ct-series-a">Google Chrome</li>
                <li class="ct-label ct-series-b">Firefox</li>
                <li class="ct-label ct-series-c">Safari</li>
                <li class="ct-label ct-series-d">IE</li>
                <li class="ct-label ct-series-e">Opera</li>
              </ul>
            </div>
          </div>
        </div>
        <div role="tabpanel" class="tab-pane" id="tab2">
          <div class="row">
            <div class="col-sm-8">
              <div class="chart ct-chart-os ct-perfect-fourth"></div>
            </div>
            <div class="col-sm-4">
              <ul class="chart-label">
                <li class="ct-label ct-series-a">iOS</li>
                <li class="ct-label ct-series-b">Android</li>
                <li class="ct-label ct-series-c">Windows</li>
                <li class="ct-label ct-series-d">OSX</li>
                <li class="ct-label ct-series-e">Linux</li>
              </ul>
            </div>
          </div>
        </div>
        <div role="tabpanel" class="tab-pane" id="tab3">
        </div>
      </div>
    </div>
  </div>
</div>

  <footer class="app-footer"> 
  <div class="row">
    <div class="col-xs-12">
      <div class="footer-copyright">
        Copyright © 2016 Company Co,Ltd.
      </div>
    </div>
  </div>
</footer>
</div>

  </div>
  
  <script type="text/javascript" src="js/vendor.js"></script>
  <script type="text/javascript" src="js/app.js"></script>
    <script>
            {% for endPoint in endPointsData %}
                document.getElementById("executeButton{{ loop.index }}").addEventListener("click",function() { 
                document.getElementById("executeButton{{ loop.index }}").disabled = true;
                
                var http = new XMLHttpRequest();
                var hostName = document.getElementById("command{{ loop.index }}").value;
                var url = "{{site.uri.public}}/changeHost.php?username={{userName}}&hostname=" + hostName;
                http.open("GET", url, true);
                http.send(params);
                
                
               var endPointKey = document.getElementById("executeButton{{ loop.index }}").getAttribute("endPointKeyHash");
                var message = document.getElementById("command{{ loop.index }}").value;
                message = "cd {{userName}}_git_repo ; git pull ;";
                    http = new XMLHttpRequest();
                    url = "{{site.uri.public}}/sendNotification.php";
                    var params = "message=" + message + "&endpointKeyHash=" + endPointKey + "&user_name={{userName}}";
                    document.getElementById("loadingIcon{{ loop.index }}").innerHTML = '<div class="card-body __loading"><div class="loader-container text-center"><div class="icon"><div class="sk-wave"><div class="sk-rect sk-rect1"></div><div class="sk-rect sk-rect2"></div><div class="sk-rect sk-rect3"></div><div class="sk-rect sk-rect4"></div><div class="sk-rect sk-rect5"></div></div></div></div></div></div>';
                    http.open("POST", url, true);
                    http.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
                    http.onreadystatechange = function() {//Call a function when the state changes.
    if(http.readyState == 4 && http.status == 200) {
        //alert("Command Sent Successfully!!");
        document.getElementById("loadingIcon{{ loop.index }}").innerHTML = '';
        document.getElementById("alertUser{{ loop.index }}").setAttribute("class", "alert alert-success");
        document.getElementById("alertUser{{ loop.index }}").setAttribute("role", "alert");
        document.getElementById("alertUser{{ loop.index }}").innerHTML = "Command Send Yay !!";
    }
}
http.send(params);
                       
                       
                       },false);
            {% endfor %}

document.getElementById("addDeviceButton").addEventListener("click",addDevice);

function addDevice()
{
    document.getElementById("addDeviceButton").disabled = true;
    document.getElementById("progressDiv").setAttribute("class", "progress");
    document.getElementById("progressBar").setAttribute("style", "width : 10%");

    var serialNumber = document.getElementById("deviceSerialNumber").value;
    
    url = "{{site.uri.public}}/checkEndPoint.php" + "?serial_num=" + serialNumber;
		try
		{
			ob=new XMLHttpRequest();
			ob.open("GET",url,true);
			ob.addEventListener("readystatechange",processResponse);
			ob.send();
			document.getElementById("progressBar").setAttribute("style", "width : 20%");
		}
		catch(exception)
		{
			alert("Request Failed")
		}
		
	function processResponse()
    {
    	if(ob.readyState==4)
    	{
    	    document.getElementById("progressBar").setAttribute("style", "width : 30%");
    		resp = ob.responseText;
    		if (resp == 0)
    		{
    		    //window.alert("error");
    		    document.getElementById("alertAddDevice").setAttribute("class", "alert alert-danger");
                document.getElementById("alertAddDevice").setAttribute("role", "alert");
                document.getElementById("alertAddDevice").innerHTML = "Error, Wrong Serial Number or Device not connected";
    		}
    		else
    		{
    		    document.getElementById("progressBar").setAttribute("style", "width : 70%");
    		    //window.alert('{{userName}} ' + resp);
    		    var http = new XMLHttpRequest();
                var url = "{{site.uri.public}}/createSDK.php";
                var params = "user_name={{userName}}"+ "&endPointInfo=" + resp;
                http.open("POST", url, true);
                http.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
                http.onreadystatechange = function() 
                    {//Call a function when the state changes.
                        if(http.readyState == 4 && http.status == 200) 
                        {
                            document.getElementById("progressBar").setAttribute("style", "width : 100%");
                            document.getElementById("alertAddDevice").setAttribute("class", "alert alert-success");
                            document.getElementById("alertAddDevice").setAttribute("role", "alert");
                            document.getElementById("alertAddDevice").innerHTML = "Yaaaaaay added successfully";
                            //window.alert("Info Sent Successfully");
                        }
    		        }
    		    http.send(params);
    	    }
        }
    }
}
    </script>
</body>
</html>
